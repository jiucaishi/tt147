added on branch 2004 by jyq

